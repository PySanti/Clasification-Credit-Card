import pandas as pd
import numpy as np
from sklearn.base import BaseEstimator, TransformerMixin



class DateConverter(BaseEstimator, TransformerMixin):
    """
        Tranformador creado para convertir todas las columnas de tipo date a float.

        Recibe la lista de columnas de date en el constructor.

        Considerar que para lograr convertir a float todos los elementos (incluyendo nan),
        se debio convertir nans a 0 para despues convertir 0 a nans de nuevo.
    """
    def __init__(self, attributes):
        self.attributes = attributes
    def fit(self, X, y=None):
        return self
    def transform(self, X, y=None):
        X = X.copy()
        def converter(col):
            return pd.to_datetime(col, errors='coerce').apply(lambda x: x.timestamp() if pd.notna(x) else 0).astype(float).replace(0, np.nan) if col.name in self.attributes else col
        return X.apply(converter)



